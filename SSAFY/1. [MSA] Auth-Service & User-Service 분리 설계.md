# Auth-Service 와 User-Service 분리 이유

MSA에서 **User-Service**와 **Auth-Service**를 분리하는 건 단순히 기능 분할이 아니라 **보안, 확장성, 책임 분리(SRP)** 관점에서 매우 중요한 설계.

---

## ✅ User-Service와 Auth-Service를 분리하는 이유

### 1. **보안(Security) 책임 분리**

- Auth-Service는 **인증/인가** 중심 기능 (JWT 생성, 검증, 토큰 갱신, OAuth 연동 등)만 담당
- User-Service는 **회원 정보 CRUD**, 프로필, 선호도, 설정 등 개인 데이터 관리
- → 인증 로직과 민감한 사용자 데이터를 분리해 **공격 표면을 최소화**할 수 있음
- 특히 JWT 시크릿 키, OAuth 클라이언트 시크릿 등은 Auth-Service 내부에만 존재 → **보안 격리 강화**
    
    ---
    
    ### 2. **단일 책임 원칙(SRP) 및 유지보수성 향상**
    
    - 기능별로 서비스를 쪼개면 코드 관리가 쉬워지고, 변경 영향도 적음
    - 예: 카카오 OAuth가 바뀌면 Auth-Service만 수정하면 됨. User-Service는 영향 없음
    - 사용자 CRUD 기능은 인증 로직과 관계없이 독립적으로 개발 및 테스트 가능
    
    ---
    
    ### 3. **확장성과 독립 배포 용이**
    
    - 인증 쪽은 로그인 트래픽이 몰릴 수 있음 → Auth-Service만 별도로 **스케일 아웃** 가능
    - 서비스 운영 중 인증 방식 변경 (예: OAuth → 패스키)에도 다른 서비스 영향 없이 대응 가능
    - 특정 인증 프로토콜만 사용하는 **Lightweight 인증 게이트웨이** 역할로도 활용 가능
    
    ---
    
    ### 4. **재사용성과 범용성**
    
    - Auth-Service는 추후 **다른 도메인 서비스에서도 재사용 가능** (ex: 관리자용 웹, 파트너용 포털 등)
    - 인증 로직을 한 곳에 집중시켜 중복 방지 + 유지보수 효율 증가
    
    ---
    
    ### 5. **Gateway와의 연계 강화**
    
    - Auth-Service에서 발급한 JWT를 Gateway에서 검증 → 다른 서비스에서는 인증 걱정 X
    - 각 서비스는 **인증된 사용자 정보만 받도록 경량화** → 핵심 비즈니스에 집중
    
    ---
    
    ### 📌 정리 요약용 문장 (PPT나 문서용)
    
    > "Auth-Service는 인증/인가 책임을 집중 관리하여 보안성과 확장성을 강화하고, User-Service는 사용자 데이터 관리에 집중함으로써 단일 책임 원칙을 지키고 서비스 독립성을 확보합니다."
    > 
    
    ---
    

## ✅ **Eureka에 등록할지 말지 판단 기준**

| 질문 | YES일 때 | NO일 때 |
| --- | --- | --- |
| 다른 MSA 서비스가 Auth-Service를 호출하는가? | ✅ **등록해야 함** | ❌ 등록 안 해도 됨 |
| Auth-Service가 내부 마이크로서비스들과 통신하는가? | ✅ 필요 | ❌ 불필요 |
| Auth-Service가 단독 외부용(프론트만 접근)? | ❌ 등록 안 해도 무방 | ✅ 외부 게이트웨이 통해 바로 호출 |

---

### 🔍 실제 상황에 맞는 시나리오 비교

### ✅ **Eureka에 등록하는 경우 (보통은 이 케이스)**

- 프론트가 Gateway로 요청 → Gateway가 `auth-service`로 라우팅
- 다른 마이크로서비스에서 `auth-service`에 토큰 검증 요청 (ex. token info API)
- 향후 인증 로직을 **내부 다른 서비스에서도 호출할 가능성**이 있다면 무조건 등록

### ❌ **등록하지 않는 경우 (매우 제한적인 구조)**

- Auth-Service는 완전히 외부용 → 클라이언트 앱이 직접 호출 (예: /login, /oauth/kakao)
- 내부 서비스에서 Auth-Service에 접근할 일이 없음
- 이 경우 Eureka, Gateway 없이 **단독 포트에 띄워 외부와만 통신**

---

### 📌 추천: **Eureka에 등록하는 것이 일반적이고 확장성에 유리함**

- 내부 서비스가 `auth-service`의 토큰 검증, 토큰 갱신 등을 사용할 수 있기 때문
- `auth-service`를 Gateway 뒤에 두고, 프론트/서비스 모두가 호출 가능하도록 설정하는 게 일반적인 구조